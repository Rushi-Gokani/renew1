{%- comment -%}
  Affiliate Application Form Section
  This section creates a form for potential affiliates to apply to the program.
  The form includes all required fields and sends data to the specified email.
{%- endcomment -%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div class="section page-width-content color-{{ section.settings.color_scheme }}">
  <div
    class="
      spacing-style
      layout-panel-flex
      layout-panel-flex--column
      section-content-wrapper
    "
    style="
      {% render 'layout-panel-style', settings: section.settings %}
      {% render 'spacing-style', settings: section.settings %}
    "
  >
    {% if section.settings.title != blank %}
      <div class="section-heading center">
        <h2 class="title">{{ section.settings.title }}</h2>
        {% if section.settings.subtitle != blank %}
          <p class="subtitle">{{ section.settings.subtitle }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="affiliate-form-wrapper">
      {%- form 'contact', id: 'AffiliateForm', class: 'affiliate-form__form' -%}
        {%- if form.errors -%}
          <div class="affiliate-form__error" tabindex="-1" autofocus>
            {{- 'icon-error.svg' | inline_asset_content -}}
            {{ form.errors.translated_fields.email | capitalize }}
            {{ form.errors.messages.email }}
          </div>
        {%- endif -%}

        {%- if form.posted_successfully? -%}
          <div class="affiliate-form__success" tabindex="-1" autofocus>
            {{- 'icon-checkmark.svg' | inline_asset_content -}}
            {{ section.settings.success_message | default: 'Thank you for your application! We will review it and get back to you soon.' }}
          </div>
          
          {%- if section.settings.redirect_url != blank -%}
            <script>
              setTimeout(function() {
                window.location.href = "{{ section.settings.redirect_url }}";
              }, 2000);
            </script>
          {%- endif -%}
        {%- endif -%}

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-email">Email*</label>
            <input
              type="email"
              id="AffiliateForm-email"
              class="affiliate-form__input"
              autocomplete="email"
              name="contact[email]"
              spellcheck="false"
              autocapitalize="off"
              value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
              aria-required="true"
              {% if form.errors contains 'email' %}
                aria-invalid="true"
                aria-describedby="AffiliateForm-email-error"
              {% endif %}
              required
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-referred-by">Were you referred by a current Affiliate? If so, add their name or handle below:</label>
            <input
              type="text"
              id="AffiliateForm-referred-by"
              class="affiliate-form__input"
              name="contact[referred_by]"
              value="{{ form.referred_by }}"
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-name">Full name*</label>
            <input
              type="text"
              id="AffiliateForm-name"
              class="affiliate-form__input"
              autocomplete="name"
              name="contact[name]"
              value="{% if form.name %}{{ form.name }}{% elsif customer %}{{ customer.name }}{% endif %}"
              required
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-location">Where are you based?*</label>
            <input
              type="text"
              id="AffiliateForm-location"
              class="affiliate-form__input"
              name="contact[location]"
              value="{{ form.location }}"
              required
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-instagram">What is your Instagram handle?*</label>
            <input
              type="text"
              id="AffiliateForm-instagram"
              class="affiliate-form__input"
              name="contact[instagram]"
              value="{{ form.instagram }}"
              placeholder="@yourhandle"
              required
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-instagram-followers">How many Instagram followers do you currently have? (min requirement 1,500)*</label>
            <input
              type="number"
              id="AffiliateForm-instagram-followers"
              class="affiliate-form__input"
              name="contact[instagram_followers]"
              value="{{ form.instagram_followers }}"
              min="1500"
              required
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-tiktok">What is your TikTok handle?</label>
            <input
              type="text"
              id="AffiliateForm-tiktok"
              class="affiliate-form__input"
              name="contact[tiktok]"
              value="{{ form.tiktok }}"
              placeholder="@yourhandle"
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-tiktok-followers">How many TikTok followers do you currently have? (min requirement 1,000)</label>
            <input
              type="number"
              id="AffiliateForm-tiktok-followers"
              class="affiliate-form__input"
              name="contact[tiktok_followers]"
              value="{{ form.tiktok_followers }}"
              min="1000"
            >
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label>Which is your primary channel?*</label>
            <div class="affiliate-form__radio-group">
              <label class="affiliate-form__radio-label">
                <input
                  type="radio"
                  name="contact[primary_channel]"
                  value="Instagram"
                  {% if form.primary_channel == 'Instagram' %}checked{% endif %}
                  required
                >
                <span>Instagram</span>
              </label>
              <label class="affiliate-form__radio-label">
                <input
                  type="radio"
                  name="contact[primary_channel]"
                  value="TikTok"
                  {% if form.primary_channel == 'TikTok' %}checked{% endif %}
                >
                <span>TikTok</span>
              </label>
              <label class="affiliate-form__radio-label">
                <input
                  type="radio"
                  name="contact[primary_channel]"
                  value="Both"
                  {% if form.primary_channel == 'Both' %}checked{% endif %}
                >
                <span>Both</span>
              </label>
            </div>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label>What content styles/topics best reflects your page? (you can select more than one)</label>
            <div class="affiliate-form__checkbox-group">
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Lifestyle"
                  {% if form.content_style contains 'Lifestyle' %}checked{% endif %}
                >
                <span>Lifestyle</span>
              </label>
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Fitness/Workouts"
                  {% if form.content_style contains 'Fitness/Workouts' %}checked{% endif %}
                >
                <span>Fitness/Workouts</span>
              </label>
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Beauty"
                  {% if form.content_style contains 'Beauty' %}checked{% endif %}
                >
                <span>Beauty</span>
              </label>
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Food/Recipes"
                  {% if form.content_style contains 'Food/Recipes' %}checked{% endif %}
                >
                <span>Food/Recipes</span>
              </label>
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Health"
                  {% if form.content_style contains 'Health' %}checked{% endif %}
                >
                <span>Health</span>
              </label>
              <label class="affiliate-form__checkbox-label">
                <input
                  type="checkbox"
                  name="contact[content_style][]"
                  value="Other"
                  {% if form.content_style contains 'Other' %}checked{% endif %}
                >
                <span>Other</span>
              </label>
            </div>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-other-channels">Do you have a blog, TikTok, YouTube channel or other social channels you use?</label>
            <textarea
              id="AffiliateForm-other-channels"
              class="affiliate-form__input affiliate-form__input--textarea"
              name="contact[other_channels]"
              rows="3"
            >{{ form.other_channels }}</textarea>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-favorite-product">What is your favourite Reneuw product and why?*</label>
            <textarea
              id="AffiliateForm-favorite-product"
              class="affiliate-form__input affiliate-form__input--textarea"
              name="contact[favorite_product]"
              rows="4"
              required
            >{{ form.favorite_product }}</textarea>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label for="AffiliateForm-why-join">Why should you be our next Reneuw Brand Affiliate?*</label>
            <textarea
              id="AffiliateForm-why-join"
              class="affiliate-form__input affiliate-form__input--textarea"
              name="contact[why_join]"
              rows="4"
              required
            >{{ form.why_join }}</textarea>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <label class="affiliate-form__checkbox-label">
              <input
                type="checkbox"
                name="contact[terms_accepted]"
                value="yes"
                required
              >
              <span>I understand that when signing up to be a part of the Reneuw Affiliate Programme, I'll receive a set of T&Cs that outlines a requirement to post my Reneuw products.*</span>
            </label>
          </div>
        </div>

        <div class="affiliate-form__row">
          <div class="affiliate-form__field">
            <button type="submit" class="affiliate-form__submit button">
              {{ section.settings.submit_button_text | default: 'Submit Application' }}
            </button>
          </div>
        </div>
      {%- endform -%}
    </div>
  </div>
</div>

{% stylesheet %}
  .affiliate-form-wrapper {
    max-width: 800px;
    margin: 0 auto;
  }

  .affiliate-form__form {
    display: flex;
    flex-direction: column;
    gap: var(--gap-lg);
  }

  .affiliate-form__row {
    display: flex;
    flex-direction: column;
  }

  .affiliate-form__field {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }

  .affiliate-form__field label {
    font-weight: 500;
    color: var(--color-foreground);
  }

  .affiliate-form__input {
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--color-input-text);
    background-color: var(--color-input-background);
    padding: var(--padding-lg) var(--padding-xl);
    border-radius: var(--style-border-radius-inputs);
    border: var(--style-border-width-inputs) solid var(--color-input-border);
    -webkit-font-smoothing: antialiased;
    font-family: inherit;
  }

  .affiliate-form__input:focus {
    outline: none;
    border-color: var(--color-button);
    box-shadow: 0 0 0 1px var(--color-button);
  }

  .affiliate-form__input--textarea {
    resize: vertical;
    min-height: 120px;
  }

  .affiliate-form__radio-group,
  .affiliate-form__checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: var(--gap-md);
    margin-top: var(--gap-xs);
  }

  .affiliate-form__radio-label,
  .affiliate-form__checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--gap-xs);
    cursor: pointer;
  }

  .affiliate-form__radio-label input,
  .affiliate-form__checkbox-label input {
    margin: 0;
  }

  .affiliate-form__submit {
    align-self: flex-start;
    margin-top: var(--gap-md);
    background-color: #00593b;
    color: white;
    border: none;
    border-radius: 8px;
    padding: var(--padding-md) var(--padding-lg);
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .affiliate-form__submit:hover {
    background-color: #00472f;
  }

  .affiliate-form__error,
  .affiliate-form__success {
    display: flex;
    align-items: center;
    gap: var(--gap-xs);
    padding: var(--padding-md);
    border-radius: var(--style-border-radius-inputs);
  }

  .affiliate-form__error {
    background-color: rgba(var(--color-error-rgb), 0.1);
    color: var(--color-error);
  }

  .affiliate-form__success {
    background-color: rgba(0, 89, 59, 0.1);
    color: #00593b;
    font-weight: 500;
    border: 1px solid rgba(0, 89, 59, 0.2);
  }

  .section-heading {
    text-align: center;
    margin-bottom: var(--gap-xl);
  }

  .section-heading .title {
    margin-bottom: var(--gap-md);
  }

  @media screen and (min-width: 750px) {
    .affiliate-form__radio-group,
    .affiliate-form__checkbox-group {
      gap: var(--gap-lg);
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Affiliate Application",
  "class": "section-wrapper",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Become a Reneuw Affiliate"
    },
    {
      "type": "richtext",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "<p>Join our community of wellness enthusiasts and earn rewards by sharing products you love.</p>"
    },
    {
      "type": "text",
      "id": "submit_button_text",
      "label": "Submit button text",
      "default": "Submit Application"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "Thank you for your application! We will review it and get back to you soon."
    },
    {
      "type": "url",
      "id": "redirect_url",
      "label": "Redirect URL",
      "info": "After successful form submission, users will be redirected to this URL"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "options": [
        {
          "value": "scheme-1",
          "label": "Scheme 1"
        },
        {
          "value": "scheme-2",
          "label": "Scheme 2"
        },
        {
          "value": "scheme-3",
          "label": "Scheme 3"
        }
      ],
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Section spacing"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 88
    }
  ],
  "presets": [
    {
      "name": "Affiliate Application Form",
      "category": "Forms"
    }
  ]
}
{% endschema %}